| Enumeration step           | Comment                                                                                     | Usefull refference                                                                                                                                                                                                            | Goal  |
|----------------------------|---------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------|
| Enumerate Hostname         | nmblookup -A [ip]                                                                           |                                                                                                                                                                                                                               |       |
| List Shares                | smbmap -H [ip/hostname]                                                                     |                                                                                                                                                                                                                               |       |
| ""                         | echo exit \| smbclient -L \\\\[ip]                                                          | exit takes care of any password request that might pop up, since we’re checking for null login  -L - get a list of shares for the given host                                                                                  |       |
| ""                         | nmap --script smb-enum-shares -p 139,445 [ip]                                               |                                                                                                                                                                                                                               |       |
| Check Null Sessions        | smbmap -H [ip/hostname]                                                                     | This command will show you the shares on the host, as well as your access to them.  If you get credentials, you can re-run to show new access                                                                                 |       |
| ""                         | rpcclient -U "" -N [ip]  smbclient \\\\[ip]\\[share name]                                   | -U "" - null session  -N - no password  This will attempt to connect to the share. Can try without a password (or sending a blank password) and still potentially connect.                                                    |       |
| Check for vulnerabilities  | nmap --script smb-vuln* -p 139,445 [ip]                                                     |                                                                                                                                                                                                                               |       |
| Overal scan                | enum4linux -a [ip]                                                                          | Example output is long, but some highlights to look for:  output similar to nmblookup  check for null session  listing of shares  domain info  password policy  RID cycling output                                            |       |
| Manual recon               | https://github.com/rewardone/OSCPRepo/blob/master/scripts/recon_enum/smbver.sh  Check pcap  | Run on server  Windows SMB is more complex than just a version, but looking in wireshark will give a bunch of information about the connection. We can filter on ntlmssp.ntlmv2_response to see NTLMv2 traffic, for example.  |       |
